/*! ts-datepicker v1.0.2, @license MIT */
var Ce=Object.defineProperty,Se=Object.defineProperties;var Oe=Object.getOwnPropertyDescriptors;var ue=Object.getOwnPropertySymbols;var Ie=Object.prototype.hasOwnProperty,He=Object.prototype.propertyIsEnumerable;var J=(s,i,e)=>i in s?Ce(s,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[i]=e,m=(s,i)=>{for(var e in i||(i={}))Ie.call(i,e)&&J(s,e,i[e]);if(ue)for(var e of ue(i))He.call(i,e)&&J(s,e,i[e]);return s},x=(s,i)=>Se(s,Oe(i));var o=(s,i,e)=>J(s,typeof i!="symbol"?i+"":i,e);var Be=["left","center","right","top","middle","bottom","outside"],Ae="datepicker-position--",c={datepicker:"datepicker",picker:"datepicker-picker",navigation:"datepicker--navigation",content:"datepicker--content",buttons:"datepicker--buttons",navContainer:"datepicker-nav",navAction:"datepicker-nav--action",navTitle:"datepicker-nav--title",body:"datepicker-body",dayNames:"datepicker-body--day-names",dayName:"datepicker-body--day-name",weekNumbers:"datepicker-body--week-numbers",daysContainer:"datepicker-days",cells:"datepicker-body--cells",cell:"datepicker-cell",buttonsContainer:"datepicker-buttons",button:"datepicker-button",active:"active",inline:"inline",hidden:"hidden",disabled:"disabled",current:"current",focused:"focus",selected:"selected",minDate:"min-date",maxDate:"max-date",otherMonth:"other-month",otherDecade:"other-decade",rangeFrom:"range-from",rangeTo:"range-to",inRange:"in-range",rangeDisabled:"range-disabled",editMode:"edit-mode",hasWeekNumbers:"has-week-numbers",positions:Be.reduce((s,i)=>(s[i]=Ae+i,s),{})};var de={prevMonth:{keys:{key:"ArrowLeft",ctrl:!0},callback:"prevMonth",preventDefault:!0},nextMonth:{keys:{key:"ArrowRight",ctrl:!0},callback:"nextMonth",preventDefault:!0},prevYear:{keys:{key:"ArrowLeft",shift:!0},callback:"prevYear",preventDefault:!0},nextYear:{keys:{key:"ArrowRight",shift:!0},callback:"nextYear",preventDefault:!0},switchView:{keys:{key:"ArrowUp",ctrl:!0},callback:"switchView",preventDefault:!0},exitEditMode:{keys:{key:"ArrowDown",ctrl:!0},callback:"exitEditMode",preventDefault:!0}};var S=["days","months","years"],X={allowInput:!0,altInput:!1,altInputFormat:"M d, yyyy",autoClose:!0,buttons:!1,classes:"",container:null,dateDelimiter:",",dateFormat:null,defaultDate:"",disabledDates:[],enabledDates:[],inline:!1,keyboardNav:!0,keybinds:de,locale:"en",maxDate:null,minDate:null,maxView:"years",minView:"days",startView:"days",monthsField:"monthsShort",multipleDates:!1,navTitles:{days:"MM, <i>yyyy</i>",months:"yyyy",years:"yyyy1 - yyyy2"},nextArrow:"",prevArrow:"",offset:0,position:"auto",range:!1,dynamicRange:!0,rtl:null,showOtherMonths:!0,selectOtherMonths:!0,selectOtherYears:!0,showOn:!0,toggleSelected:!0,updateOnBlur:!0,weekNumbers:!1,weekStart:null,onBeforeSelect:null,onRenderCell:null,onShow:null,onHide:null,onFocus:null,onChangeDate:null,onChangeView:null,onChangeViewDate:null};function pe(){return X}var A=class{constructor(){o(this,"__listeners",new Map)}on(i,e){if(!e)return()=>{};let t=this.__listeners.get(i);return t||(t=[],this.__listeners.set(i,t)),t.push(e),()=>this.off(i,e)}off(i,e){if(typeof i=="undefined")return this.__listeners.clear();if(typeof e=="undefined"){this.__listeners.delete(i);return}let t=this.__listeners.get(i);if(t){let n=t.indexOf(e);n>-1&&(t.splice(n,1),t.length||this.__listeners.delete(i))}}trigger(i,e){i instanceof CustomEvent||(i=new CustomEvent(i,{detail:e}));let t=this.__listeners.get(i.type);t&&t.forEach(n=>n(i))}};var fe={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",format:"mm/dd/yyyy",weekStart:0},me={default:fe,en:fe};var Z={today:{content:s=>s.locale.today,onClick:s=>{let i=new Date;if(s.config.range)s.selectDate([i,i]);else{let e=s.adapter.getSelectedDate(i);e?s.adapter.handleAlreadySelectedDates(e,i):s.selectDate(i)}}},clear:{content:s=>s.locale.clear,onClick:s=>s.clear()}};function ge(s){return Z[s]}function V(s){let i=document.createElement("template");return i.innerHTML=s,i.content}function M(...s){let i=[];return s.forEach(e=>{if(typeof e=="object")for(let t in e)e[t]&&i.push(t);else e&&i.push(e)}),i}function G(s){let i=Ne(s);return!i||i===document.body?null:window.getComputedStyle(i).overflow==="visible"?G(i):i}function Ne(s){return s.parentElement||(s.parentNode instanceof ShadowRoot?s.parentNode.host:null)}function Q(s){return window.getComputedStyle(s).direction}var N=class{constructor(i){o(this,"datePicker");o(this,"element");this.datePicker=i,this.element=document.createElement("div"),this.element.classList.add(c.buttonsContainer),this._render()}destroy(){this.datePicker=null,this.element.remove(),this.element=null}update(){this._clearButtons(),this._render()}_render(){let i=this.datePicker.config.buttons;i===!1||this.element.childElementCount||(Array.isArray(i)||(i=[i]),i.forEach(e=>{if(typeof e=="string"){if(!Z[e])return;e=ge(e)}let t=this._createButton(e);this.element.append(t)}))}_createButton(i){let e=document.createElement(i.tagName||"button"),t=typeof i.content=="function"?i.content(this.datePicker):i.content;if(e.append(V(t)),e.classList.add(...M(c.button,i.className)),i.attributes&&Object.keys(i.attributes).forEach(n=>{i.attributes[n]!==void 0&&e.setAttribute(n,i.attributes[n])}),i.onClick){let n=i.onClick;e.addEventListener("click",()=>n(this.datePicker))}return e}_clearButtons(){this.element.innerHTML=""}};function k(s){return new Date(s).setHours(0,0,0,0)}function H(){return new Date().setHours(0,0,0,0)}function v(s){let i=Math.floor(s.getFullYear()/10)*10;return[i,i+9]}function ye(s){return new Date(s.getFullYear(),s.getMonth()+1,0).getDate()}function ee(s,i){return new Date(s.getFullYear(),s.getMonth(),s.getDate()+i)}function ke(s,i){return new Date(s.getFullYear(),s.getMonth(),s.getDate()-i)}function R(s,i=!1){return s.slice().sort((e,t)=>i?e.getTime()-t.getTime():k(e)-k(t))}function f(s,i,e){if(!s||!i)return!1;switch(e){case"days":return s.getDate()===i.getDate()&&s.getMonth()===i.getMonth()&&s.getFullYear()===i.getFullYear();case"months":return s.getMonth()===i.getMonth()&&s.getFullYear()===i.getFullYear();case"years":return s.getFullYear()===i.getFullYear()}}function w(s,i,e=!1){let t=k(s),n=k(i);return e?t<=n:t<n}function y(s,i,e=!1){let t=k(s),n=k(i);return e?t>=n:t>n}function be(s,i,e){return y(s,i)&&w(s,e)}function De(s,i){return(s-i+7)%7}function F(s,i,e){s=typeof s=="number"?new Date(s):s;let t=s.getDay();return ee(s,De(i,e)-De(t,e))}function ve(s,i){switch(i){case 6:return Ke(s);case 0:return Ye(s);default:return Re(s)}}function Re(s){let i=F(s,4,1),e=F(new Date(i).setMonth(0,4),4,1);return we(i.getTime(),e.getTime())}function Ye(s){return Ee(s,0)}function Ke(s){return Ee(s,6)}function we(s,i){return Math.round((s-i)/6048e5)+1}function Ee(s,i){let e=F(new Date(s).setMonth(0,1),i,i),t=F(s,i,i),n=we(t.getTime(),e.getTime());if(n<53)return n;let a=F(new Date(s).setDate(32),i,i);return t===a?1:n}var te=Object.prototype.toString,je=Object.prototype.hasOwnProperty,Le=Symbol.prototype.valueOf,_e=Object.keys,We=ArrayBuffer.isView;function se(s,i){return ie(s,i)}function ie(s,i,e,t){if(s===i)return s!==0||1/s===1/i;if(s==null||i==null)return!1;if(s!==s)return i!==i;let n=typeof s;return n!=="function"&&n!=="object"&&typeof i!="object"?!1:$e(s,i,e,t)}function $e(s,i,e,t){let n=te.call(s);if(n!==te.call(i))return!1;switch(n){case"[object RegExp]":case"[object String]":return""+s==""+i;case"[object Number]":return+s!=+s?+i!=+i:+s==0?1/+s===1/i:+s==+i;case"[object Date]":case"[object Boolean]":return+s==+i;case"[object Symbol]":return Le.call(s)===Le.call(i);case"[object ArrayBuffer]":case"[object DataView]":return!1}let a=n==="[object Array]";if(!a&&Ue(s)){if(Pe(s)!==Pe(i))return!1;if(s.buffer===i.buffer&&s.byteOffset===i.byteOffset)return!0;a=!0}if(!a){if(typeof s!="object"||typeof i!="object")return!1;let l=s.constructor,h=i.constructor;if(l!==h&&!(typeof l=="function"&&l instanceof l&&typeof h=="function"&&h instanceof h)&&"constructor"in s&&"constructor"in i)return!1}e=e||[],t=t||[];let r=e.length;for(;r--;)if(e[r]===s)return t[r]===i;if(e.push(s),t.push(i),a){if(r=s.length,r!==i.length)return!1;for(;r--;)if(!ie(s[r],i[r],e,t))return!1}else{let l=_e(s),h;if(r=l.length,_e(i).length!==r)return!1;for(;r--;)if(h=l[r],!(ze(i,h)&&ie(s[h],i[h],e,t)))return!1}return e.pop(),t.pop(),!0}function ze(s,i){return s!=null&&je.call(s,i)}function Pe(s){return s==null?void 0:s.byteLength}function Ue(s){return We(s)&&te.call(s)!=="[object DataView]"}var Y=class{constructor(i){o(this,"datePicker");o(this,"keybinds",[]);o(this,"keydownListener");this.datePicker=i;let e=this.datePicker.altInput||this.datePicker.element;this.keydownListener=this._onKeydown.bind(this),e.addEventListener("keydown",this.keydownListener);let t=this.datePicker.config.keybinds;t&&Object.keys(t).forEach(n=>this.on(t[n]))}destroy(){this.datePicker.element.removeEventListener("keydown",this.keydownListener),this.datePicker=null,this.keybinds=null}on(i){if(Array.isArray(i))return i.forEach(a=>this.on(a)),this;if(!i.keys||!i.callback)return this;if(Array.isArray(i.keys))return i.keys.forEach(a=>this.on(x(m({},i),{keys:a}))),this;let e=x(m({},i),{keys:x(m({},i.keys),{key:i.keys.key.toLowerCase()})}),t=this.keybinds.find(a=>se(a.keys,e.keys));return t||(t={keys:e.keys,callbacks:[]},this.keybinds.push(t)),(Array.isArray(e.callback)?e.callback:[e.callback]).forEach(a=>t.callbacks.push({callback:a,preventDefault:!!e.preventDefault})),this}off(i){if(!i)return this.keybinds=[],this;if(Array.isArray(i))return i.forEach(t=>this.off(t)),this;if(!i.keys)return this;if(Array.isArray(i.keys))return i.keys.forEach(t=>this.off(x(m({},i),{keys:t}))),this;i=x(m({},i),{keys:x(m({},i.keys),{key:i.keys.key.toLowerCase()})});let e=this.keybinds.find(t=>se(t.keys,i.keys));return e&&(i.callback&&(Array.isArray(i.callback)?i.callback:[i.callback]).forEach(n=>{let a=e.callbacks.findIndex(r=>r.callback===n);a>=0&&e.callbacks.splice(a,1)}),(!i.callback||!e.callbacks.length)&&this.keybinds.splice(this.keybinds.indexOf(e),1)),this}_onKeydown(i){let e=this.datePicker.isEditMode(),t=i.key.toLowerCase();if(t==="tab"){this._unfocus();return}if(t==="enter")if(i.preventDefault(),!this.datePicker.visible)this.datePicker.show();else if(e)this.datePicker.adapter.exitEditMode(!0);else{if(!this.datePicker.isMinView()){this.datePicker.changeView("down");return}let a=this.datePicker.focusDate;if(a){let r=this.datePicker.adapter.getSelectedDate(a);r?this.datePicker.adapter.handleAlreadySelectedDates(r,a):this.datePicker.selectDate(a);return}}if(t==="escape"){this.datePicker.hide();return}let n=this._findKeybinds(i);if(n.length){this._handleKeybinds(i,n);return}if(!e&&this._focusNextCell(t)){i.preventDefault();return}}_findKeybinds(i){let e=i.key.toLowerCase(),t=i.ctrlKey||i.metaKey,{shiftKey:n,altKey:a}=i;return this.keybinds.filter(r=>r.keys.key==e&&(r.keys.ctrl==null||r.keys.ctrl===t)&&(r.keys.shift==null||r.keys.shift===n)&&(r.keys.alt==null||r.keys.alt===a))}_handleKeybinds(i,e){e.sort((t,n)=>Object.keys(n.keys).length-Object.keys(t.keys).length),e[0].callbacks.forEach(t=>{typeof t.callback=="string"?this._action(t.callback):t.callback(i,this.datePicker),t.preventDefault&&i.preventDefault()})}_action(i){switch(i){case"show":this.datePicker.show();break;case"hide":this.datePicker.hide();break;case"toggle":this.datePicker.visible?this.datePicker.hide():this.datePicker.show();break;case"prevMonth":case"nextMonth":case"prevYear":case"nextYear":break;case"switchView":this.datePicker.changeView("up");break;case"clear":this.datePicker.clear();break;case"today":this.datePicker.setViewDate(new Date);break;case"exitEditMode":this.datePicker.adapter.exitEditMode();break}}_focusNextCell(i){let{currentView:e}=this.datePicker,t=this._getFocusDate(),[n,a,r]=[t.getFullYear(),t.getMonth(),t.getDate()];switch(i){case"arrowleft":e==="days"&&(r-=1),e==="months"&&(a-=1),e==="years"&&(n-=1);break;case"arrowright":e==="days"&&(r+=1),e==="months"&&(a+=1),e==="years"&&(n+=1);break;case"arrowup":e==="days"&&(r-=7),e==="months"&&(a-=3),e==="years"&&(n-=4);break;case"arrowdown":e==="days"&&(r+=7),e==="months"&&(a+=3),e==="years"&&(n+=4);break;default:return!1}let l=this._clampDate(new Date(n,a,r));return this.datePicker.setFocusDate(l,!0),!0}_getFocusDate(){let{focusDate:i,selectedDates:e,viewDate:t}=this.datePicker,[n,a]=[t.getFullYear(),t.getMonth()],r=i||e[e.length-1];if(!r)switch(this.datePicker.currentView){case"days":r=new Date(n,a,new Date().getDate());break;case"months":r=new Date(n,a,1);break;case"years":r=new Date(n,0,1);break}return r}_clampDate(i){let{minDate:e,maxDate:t}=this.datePicker;return t&&y(i,t)?t:e&&w(i,e)?e:i}_unfocus(){this.datePicker.element!==document.activeElement&&(this.datePicker.config.updateOnBlur?this.datePicker.adapter.exitEditMode(!0):this.datePicker.adapter.setInputValue(),this.datePicker.hide())}};var qe={days:"MM, <i>yyyy</i>",months:"yyyy",years:"yyyy1 - yyyy2"},K='<svg width="18" height="18" fill="currentColor" viewBox="0 0 16 16"><path d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708"></path></svg>',j='<svg width="18" height="18" fill="currentColor" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0"></path></svg>',W=class{constructor(i){o(this,"datePicker");o(this,"element");o(this,"prevButton");o(this,"nextButton");o(this,"titleElement");o(this,"prevClickListener");o(this,"nextClickListener");o(this,"titleClickListener");o(this,"changeViewListener");o(this,"changeDateListener");this.datePicker=i,this.element=document.createElement("nav"),this.element.classList.add(c.navContainer),this._buildHtml(),this._updateArrows(),this.changeViewListener=()=>this._onChangeView(),this.changeDateListener=()=>setTimeout(()=>this.render()),this.datePicker.on("_changeCurrentView",this.changeViewListener),this.datePicker.on("changeViewDate",this.changeViewListener),this._hasNavTitleCallback()&&this.datePicker.on("_changeSelectedDate",this.changeDateListener),this.render(),this._updateNavStatus()}destroy(){this.datePicker.off("changeViewDate",this.changeViewListener),this.datePicker.off("_changeCurrentView",this.changeViewListener),this.datePicker.off("_changeSelectedDate",this.changeDateListener),this.datePicker=null,this.prevButton=null,this.nextButton=null,this.titleElement=null,this.element.remove(),this.element=null}render(){this.titleElement.innerHTML=this._getTitle(),this.titleElement.classList.toggle(c.disabled,this.datePicker.isMaxView())}update(){this.render(),this._updateNavStatus(),this._updateArrows()}_buildHtml(){this.prevClickListener=()=>this.datePicker.prev(),this.nextClickListener=()=>this.datePicker.next(),this.titleClickListener=()=>this.datePicker.changeView("up");let{nextArrow:i,prevArrow:e}=this.datePicker.config,t=this.datePicker.rtl;this.prevButton=document.createElement("button"),this.prevButton.classList.add(c.navAction,"prev"),this.prevButton.setAttribute("data-action","prev"),this.prevButton.append(V(t?i||K:e||j)),this.prevButton.addEventListener("click",this.prevClickListener),this.nextButton=document.createElement("button"),this.nextButton.classList.add(c.navAction,"next"),this.nextButton.setAttribute("data-action","next"),this.nextButton.append(V(t?e||j:i||K)),this.nextButton.addEventListener("click",this.nextClickListener),this.titleElement=document.createElement("button"),this.titleElement.classList.add(c.navTitle),this.titleElement.addEventListener("click",this.titleClickListener),this.element.append(this.prevButton,this.titleElement,this.nextButton)}_updateArrows(){let{nextArrow:i,prevArrow:e}=this.datePicker.config,t=this.datePicker.rtl;this.prevButton.innerHTML="",this.prevButton.append(V(t?i||K:e||j)),this.nextButton.innerHTML="",this.nextButton.append(V(t?e||j:i||K))}_hasNavTitleCallback(){let i=this.datePicker.config.navTitles;return Object.keys(i).some(e=>typeof i[e]=="function")}_getTitle(){let i=this.datePicker.currentView,e=this.datePicker.config.navTitles[i];return typeof e=="function"?e(this.datePicker):this.datePicker.formatDate(this.datePicker.viewDate,e||qe[i])}_onChangeView(){this.render(),this._updateNavStatus()}_updateNavStatus(){let{minDate:i,maxDate:e,viewDate:t}=this.datePicker;if(this.prevButton.disabled=!1,this.prevButton.classList.remove(c.disabled),this.nextButton.disabled=!1,this.nextButton.classList.remove(c.disabled),!(!i&&!e))switch(this.datePicker.currentView){case"days":i&&i.getMonth()>=t.getMonth()&&i.getFullYear()>=t.getFullYear()&&(this.prevButton.disabled=!0,this.prevButton.classList.add(c.disabled)),e&&e.getMonth()<=t.getMonth()&&e.getFullYear()<=t.getFullYear()&&(this.nextButton.disabled=!0,this.nextButton.classList.add(c.disabled));break;case"months":i&&i.getFullYear()>=t.getFullYear()&&(this.prevButton.disabled=!0,this.prevButton.classList.add(c.disabled)),e&&e.getFullYear()<=t.getFullYear()&&(this.nextButton.disabled=!0,this.nextButton.classList.add(c.disabled));break;case"years":let n=v(t);i&&i.getFullYear()>=n[0]&&(this.prevButton.disabled=!0,this.prevButton.classList.add(c.disabled)),e&&e.getFullYear()<=n[1]&&(this.nextButton.disabled=!0,this.nextButton.classList.add(c.disabled));break}}};var Je={days:"day",months:"month",years:"year"},$=class{constructor(i,e,t){o(this,"datePicker");o(this,"type");o(this,"date");o(this,"focused",!1);o(this,"disabled",!1);o(this,"selected",!1);o(this,"element");o(this,"renderOptions",null);o(this,"changeFocusListener");o(this,"changeSelectedListener");this.datePicker=i,this.type=e,this.date=t;let{onRenderCell:n}=this.datePicker.config;n&&(this.renderOptions=n(this.date,this.type,this.datePicker)||null),this._createElement(),this.changeFocusListener=({detail:{date:a}})=>this._onChangeFocus(a),this.changeSelectedListener=()=>this._onChangeSelected(),this.datePicker.on("_changeSelectedDate",this.changeSelectedListener),this.datePicker.on("_changeFocusedDate",this.changeFocusListener)}destroy(){this.datePicker.off("_changeSelectedDate",this.changeSelectedListener),this.datePicker.off("_changeFocusedDate",this.changeFocusListener),this.datePicker=null,this.element.remove(),this.element=null}render(){this.element.innerHTML=this._getContent(),this._updateClasses(),this._updateFocused(),this._updateSelected(),this._updateRangeStatus()}_createElement(){var a,r;let[i,e,t]=[this.date.getFullYear(),this.date.getMonth(),this.date.getDate()],n=m({"data-year":i+"","data-month":e+"","data-date":t+"","data-iso-date":`${i}-${e}-${t}`},(a=this.renderOptions)==null?void 0:a.attributes);this.element=document.createElement("div"),this.element.classList.add(...M(c.cell,Je[this.type],(r=this.renderOptions)==null?void 0:r.classes)),Object.keys(n).forEach(l=>{this.element.setAttribute(l,n[l])})}_getContent(){var e;if((e=this.renderOptions)!=null&&e.content)return this.renderOptions.content;let i=this.datePicker.config;switch(this.type){case"days":return i.showOtherMonths||!this.datePicker.isOtherMonth(this.date)?""+this.date.getDate():"";case"months":return this.datePicker.locale[i.monthsField][this.date.getMonth()];case"years":return""+this.date.getFullYear()}}_updateClasses(){var l;let{config:i,minDate:e,maxDate:t}=this.datePicker,n=this._isOutOfMinMaxRange(),a=this.datePicker.isDateDisabled(this.date)||((l=this.renderOptions)==null?void 0:l.disabled)||!1,r=this.element.classList;switch(r.toggle(c.current,f(new Date,this.date,this.type)),r.toggle(c.minDate,e&&f(e,this.date,this.type)||!1),r.toggle(c.maxDate,t&&f(t,this.date,this.type)||!1),this.type){case"days":let h=this.datePicker.isOtherMonth(this.date);this.disabled=!i.selectOtherMonths&&h||n||a,r.toggle(c.otherMonth,h),r.toggle(c.disabled,this.disabled);break;case"months":this.disabled=n||a,r.toggle(c.disabled,a);break;case"years":let u=this.datePicker.isOtherDecade(this.date);this.disabled=!i.selectOtherYears&&u||n||a,r.toggle(c.otherDecade,u),r.toggle(c.disabled,this.disabled);break}}_updateFocused(){this.focused=f(this.datePicker.focusDate,this.date,this.type),this.element.classList.toggle(c.focused,this.focused)}_updateSelected(){this.selected=this.datePicker.isDateSelected(this.date,this.type),this.element.classList.toggle(c.selected,this.selected)}_updateRangeStatus(){let{focusDate:i,selectedDates:e}=this.datePicker;if(this.element.classList.remove(c.rangeFrom,c.rangeTo,c.inRange),!e.length||!this.datePicker.config.range)return;let{rangeDateFrom:t,rangeDateTo:n}=this.datePicker,a=this.element.classList;if(e.length===1&&i){let r=y(i,e[0]);t=r?e[0]:i,n=r?i:e[0]}a.toggle(c.inRange,t&&n&&be(this.date,t,n)||!1),a.toggle(c.rangeFrom,t&&f(this.date,t,this.type)||!1),a.toggle(c.rangeTo,n&&f(this.date,n,this.type)||!1)}_isOutOfMinMaxRange(){let{minDate:i,maxDate:e}=this.datePicker;if(!i&&!e)return!1;let t=this.type==="days",n=this.type==="years",a=!1;if(i){let r=new Date(this.date.getFullYear(),(n?i:this.date).getMonth(),(t?this.date:i).getDate());a=w(r,i)}if(e&&!a){let r=new Date(this.date.getFullYear(),(n?e:this.date).getMonth(),(t?this.date:e).getDate());a=y(r,e)}return a}_onChangeFocus(i){this._updateFocused(),i&&this._updateRangeStatus()}_onChangeSelected(){this.disabled||(this._updateSelected(),this._updateRangeStatus())}};var Xe={days:`<div class="${c.daysContainer}"><div class="${c.dayNames}"></div><div class="${c.cells} days"></div></div>`,months:`<div class="${c.cells} months"></div>`,years:`<div class="${c.cells} years"></div>`},Ze=`<div class="${c.weekNumbers}"><div class="${c.dayNames}"><div class="${c.dayName}">&nbsp;</div></div><div class="${c.cells} weeks"></div></div>`,B=class s{constructor(i,e){o(this,"datePicker");o(this,"element");o(this,"selected",[]);o(this,"type");o(this,"isMinView",!1);o(this,"visible",!0);o(this,"cellsElement");o(this,"dayNamesElement");o(this,"weeksElement",null);o(this,"weeksContainer",null);o(this,"_cells",[]);o(this,"_cellsMap",new WeakMap);o(this,"_isRange",!1);o(this,"_pressed",!1);o(this,"_focusedDate",null);o(this,"_rangeFromFocused",!1);o(this,"_rangeToFocused",!1);o(this,"_rangeMoved",!1);o(this,"_ignoreClick",!1);o(this,"mouseOverListener");o(this,"mouseOutListener");o(this,"clickListener");o(this,"mouseDownListener");o(this,"mouseMoveListener");o(this,"mouseUpListener");o(this,"changeViewListener");o(this,"changeViewDateListener");this.datePicker=i,this.type=e;let t=this.datePicker.config;if(this.element=document.createElement("div"),this.element.classList.add(c.body,this.type),this.element.innerHTML=Xe[this.type],this.cellsElement=this.element.querySelector(`.${c.cells}`),this.dayNamesElement=this.type==="days"?this.element.querySelector(`.${c.dayNames}`):null,this.isMinView=this.type===t.minView,this.type==="days"){this.dayNamesElement&&this._renderDayNames();let n=document.createElement("div");n.innerHTML=Ze,this.weeksElement=n.firstElementChild,this.weeksContainer=this.weeksElement.querySelector(`.${c.cells}`),t.weekNumbers&&this.element.prepend(this.weeksElement)}this.mouseOverListener=this._onMouseOver.bind(this),this.mouseOutListener=this._onMouseOut.bind(this),this.clickListener=this._onClick.bind(this),this.mouseDownListener=this._onMouseDown.bind(this),this.mouseMoveListener=this._onMouseMove.bind(this),this.mouseUpListener=this._onMouseUp.bind(this),this.element.addEventListener("mouseover",this.mouseOverListener),this.element.addEventListener("mouseout",this.mouseOutListener),this.element.addEventListener("click",this.clickListener),t.range&&t.dynamicRange&&(this._isRange=!0,this._bindRangeListeners()),this.changeViewListener=n=>this._onChangeView(n.detail),this.changeViewDateListener=({detail:n})=>this._onChangeViewDate(n.date,n.oldDate),this.datePicker.on("_changeCurrentView",this.changeViewListener),this.datePicker.on("changeViewDate",this.changeViewDateListener),this.render()}destroy(){this._removeRangeListeners(),this.datePicker.off("_changeCurrentView",this.changeViewListener),this.datePicker.off("changeViewDate",this.changeViewDateListener),this.datePicker=null,this._destroyCells(),this._cellsMap=null,this.cellsElement=null,this.dayNamesElement=null,this.weeksContainer=null,this.weeksElement=null,this.element.remove(),this.element=null}render(){this._destroyCells(),this._generateCells(),this._cells.forEach(i=>i.render()),this.type==="days"&&this._renderWeekNumbers()}update(){this.render(),this.type==="days"&&(this._renderDayNames(),this.datePicker.config.weekNumbers?this.element.contains(this.weeksElement)||this.element.prepend(this.weeksElement):this.weeksElement.remove());let i=this.datePicker.config,e=i.range&&i.dynamicRange;e&&!this._isRange?this._bindRangeListeners():!e&&this._isRange&&this._removeRangeListeners()}show(){this.visible=!0,this.element.classList.remove(c.hidden)}hide(){this.visible=!1,this.element.classList.add(c.hidden)}_bindRangeListeners(){this.element.addEventListener("mousedown",this.mouseDownListener)}_removeRangeListeners(){this.element.removeEventListener("mousedown",this.mouseDownListener),this.element.removeEventListener("mousemove",this.mouseMoveListener),document.removeEventListener("mouseup",this.mouseUpListener)}_renderDayNames(){let e=this.datePicker.weekStart;this.dayNamesElement.innerHTML="";for(let t=0;t<7;t++){let n=e%7,a=document.createElement("div");a.classList.add(c.dayName),a.setAttribute("data-day-index",n+""),a.textContent=this.datePicker.locale.daysMin[n],this.dayNamesElement.append(a),e++}}_renderWeekNumbers(){if(!this.datePicker.config.weekNumbers)return;this.weeksContainer.innerHTML="";let{viewDate:i,weekStart:e}=this.datePicker,t=new Date(i.getFullYear(),i.getMonth(),1),n=F(t,e,e),a=this._cells.length/7;for(let r=0;r<a;r++){let l=document.createElement("div");l.classList.add(c.cell,"week"),l.textContent=""+ve(ee(n,7*r),e),this.weeksContainer.append(l)}}_destroyCells(){this._cells.forEach(i=>{this._cellsMap.delete(i.element),i.destroy()}),this._cells=[],this.cellsElement.innerHTML=""}_generateCells(){s.getDatesFunction(this.type)(this.datePicker).forEach(e=>{let t=new $(this.datePicker,this.type,e);this._cells.push(t),this._cellsMap.set(t.element,t),this.cellsElement.append(t.element)})}_onChangeView(i){i!==this.type?this.hide():(this.show(),this.render())}_onChangeViewDate(i,e){if(!this.visible)return;let t=v(i),n=v(e);switch(this.datePicker.currentView){case"days":if(f(i,e,"months"))return;break;case"months":if(f(i,e,"years"))return;break;case"years":if(t[0]===n[0]&&t[1]===n[1])return;break}this.render()}_onMouseOver(i){if(i.target instanceof HTMLElement){let e=i.target.closest(`.${c.cell}`),t=e?this._cellsMap.get(e):null;this.datePicker.setFocusDate(t?t.date:null)}}_onMouseOut(){this.datePicker.setFocusDate(null)}_onClick(i){if(i.target instanceof HTMLElement){let e=i.target.closest(`.${c.cell}`),t=e?this._cellsMap.get(e):null;if(t&&!t.disabled){if(!this.datePicker.isMinView()){this.datePicker.changeView("down");return}if(this._ignoreClick){this._ignoreClick=!1;return}let n=this.datePicker.adapter.getSelectedDate(t.date,t.type);n?this.datePicker.adapter.handleAlreadySelectedDates(n,t.date):this.datePicker.selectDate(t.date)}}}_onMouseDown(i){if(!this.datePicker.isMinView()||!(i.target instanceof HTMLElement))return;let e=i.target.closest(`.${c.cell}`),t=e?this._cellsMap.get(e):null;t&&(this._pressed=!0,this.element.addEventListener("mousemove",this.mouseMoveListener),document.addEventListener("mouseup",this.mouseUpListener),this._focusedDate=new Date(t.date),f(t.date,this.datePicker.rangeDateFrom,"days")&&(this._rangeFromFocused=!0),f(t.date,this.datePicker.rangeDateTo,"days")&&(this._rangeToFocused=!0))}_onMouseMove(i){if(!this._pressed||!this.datePicker.isMinView()||!(i.target instanceof HTMLElement))return;let e=i.target.closest(`.${c.cell}`),t=e?this._cellsMap.get(e):null,n=this.datePicker.config.onBeforeSelect,a=this.datePicker.pickerElement.classList;if(!t||t.disabled||n&&!n(t.date,this.datePicker)){a.add(c.rangeDisabled);return}let{rangeDateFrom:r,rangeDateTo:l}=this.datePicker;if(this.datePicker.selectedDates.length===2){let[h,,u]=R([r,t.date,l]);if(this.datePicker.isDisabledDateInRange(h,u)){a.add(c.rangeDisabled);return}else a.remove(c.rangeDisabled);this._rangeFromFocused?y(t.date,l)?(t.date.setHours(l.getHours()),t.date.setMinutes(l.getMinutes()),l.setHours(r.getHours()),l.setMinutes(r.getMinutes()),this.datePicker.rangeDateTo=t.date,this.datePicker.rangeDateFrom=l,this.datePicker.replaceDate(l,t.date),this.datePicker.replaceDate(r,l),this._rangeFromFocused=!1,this._rangeToFocused=!0,this._rangeMoved=!0):w(t.date,l)&&(t.date.setHours(r.getHours()),t.date.setMinutes(r.getMinutes()),this.datePicker.rangeDateFrom=t.date,this.datePicker.replaceDate(r,t.date),this._rangeMoved=!0):this._rangeToFocused&&(w(t.date,r)?(t.date.setHours(r.getHours()),t.date.setMinutes(r.getMinutes()),r.setHours(l.getHours()),r.setMinutes(l.getMinutes()),this.datePicker.rangeDateFrom=t.date,this.datePicker.rangeDateTo=r,this.datePicker.replaceDate(r,t.date),this.datePicker.replaceDate(l,r),this._rangeToFocused=!1,this._rangeFromFocused=!0,this._rangeMoved=!0):y(t.date,r)&&(t.date.setHours(l.getHours()),t.date.setMinutes(l.getMinutes()),this.datePicker.rangeDateTo=t.date,this.datePicker.replaceDate(l,t.date),this._rangeMoved=!0))}}_onMouseUp(i){if(this._pressed=!1,this._rangeFromFocused=!1,this._rangeToFocused=!1,this._ignoreClick=!1,i.target instanceof HTMLElement&&this.datePicker.selectedDates.length===2){let e=i.target.closest(`.${c.cell}`),t=e?this._cellsMap.get(e):null;t&&f(t.date,this._focusedDate,this.type)&&this._rangeMoved&&(this._ignoreClick=!0)}this._rangeMoved=!1,this._focusedDate=null,this.element.removeEventListener("mousemove",this.mouseMoveListener),document.removeEventListener("mouseup",this.mouseUpListener)}static getDatesFunction(i){switch(i){case"days":return s.getDaysDates;case"months":return s.getMonthsDates;case"years":return s.getYearsDates}}static getDaysDates(i){let{viewDate:e,weekStart:t}=i,n=ye(e),a=e.getFullYear(),r=e.getMonth(),l=new Date(a,r,1),h=new Date(a,r,n),u=[],d=l.getDay()-t,p=6-h.getDay()-t;d=d<0?d+7:d,p=p>6?p-7:p;let D=ke(l,d),P=n+d+p,T=D.getDate(),C=D.getFullYear(),I=D.getMonth();for(let _=0;_<P;_++)u.push(new Date(C,I,T+_));return u}static getMonthsDates(i){let e=i.viewDate.getFullYear(),t=[];for(let n=0;n<12;n++)t.push(new Date(e,n));return t}static getYearsDates(i){let e=i.viewDate,t=v(e),n=[];for(let a=t[0]-1;a<=t[1]+1;a++)n.push(new Date(a,0));return n}};var ne={},ae=/yy(?:yy)?(?:1|2)?|mm?|MM?|dd?|DD?|o/,Ge=/[\s!-/:-@[-`{-~年月日]+/,Me={y:(s,i)=>new Date(s).setFullYear(parseInt(i,10)),m:(s,i,e)=>{let t=new Date(s),n=parseInt(i,10)-1;if(isNaN(n)){if(!i)return NaN;let a=i.toLowerCase(),r=l=>l.toLowerCase().startsWith(a);if(n=e.monthsShort.findIndex(r),n<0&&(n=e.months.findIndex(r)),n<0)return NaN}return t.setMonth(n),t.getMonth()!==Te(n)?t.setDate(0):t.getTime()},d:(s,i)=>new Date(s).setDate(parseInt(i,10))},Qe={d:s=>s.getDate().toString(),dd:s=>O(s.getDate(),2),D:(s,i)=>i.daysShort[s.getDay()],DD:(s,i)=>i.days[s.getDay()],o:s=>Math.round((new Date(s.getFullYear(),s.getMonth(),s.getDate()).getTime()-new Date(s.getFullYear(),0,0).getTime())/864e5).toString(),m:s=>(s.getMonth()+1).toString(),mm:s=>O(s.getMonth()+1,2),M:(s,i)=>i.monthsShort[s.getMonth()],MM:(s,i)=>i.months[s.getMonth()],yy:s=>O(s.getFullYear(),2).slice(-2),yyyy:s=>O(s.getFullYear(),4),yyyy1:s=>O(v(s)[0],4),yyyy2:s=>O(v(s)[1],4)};function O(s,i){return s.toString().padStart(i,"0")}function Te(s){return s>-1?s%12:Te(s+12)}function xe(s){if(typeof s!="string")throw new Error("Invalid date format");if(s in ne)return ne[s];let i=s.match(new RegExp(ae,"g")),e=s.split(ae);if(!e.length||!i)throw new Error("Invalid date format");let t=i.map(a=>Qe[a]),n=Object.keys(Me).reduce((a,r)=>(i.find(h=>h[0]!=="D"&&h[0].toLowerCase()===r)&&a.push(r),a),[]);return ne[s]={parse:(a,r)=>{let l=a.split(Ge).reduce((u,d,p)=>{if(d.length>0&&i[p]){let D=i[p][0];D==="M"?u.m=d:D!=="D"&&(u[D]=d)}return u},{}),h=n.reduce((u,d)=>{let p=Me[d](u,l[d],r);return isNaN(p)?u:p},H());return new Date(h)},format:(a,r)=>t.reduce((h,u,d)=>h+`${e[d]}${u(a,r)}`,"")+e[e.length-1]}}function z(s,i,e){if(s instanceof Date||typeof s=="number"){let t=k(s);return isNaN(t)?void 0:new Date(t)}if(s){if(s==="today")return new Date(H());if(typeof i!="string"){let t=i.toValue?i.toValue(s,i,e):void 0;return typeof t!="undefined"&&!isNaN(t)?new Date(k(t)):void 0}return xe(i).parse(s,e)}}function Ve(s,i,e){if(isNaN(s)||!s&&s!==0)return"";let t=typeof s=="number"?new Date(s):s;return typeof i!="string"?i.toDisplay?i.toDisplay(t,i,e):"":xe(i).format(t,e)}function re(s){return typeof s=="string"?ae.test(s):!!(s.toDisplay&&s.toValue)}function U(s){if(typeof s=="object"&&s!==null){if(typeof Object.getPrototypeOf=="function"){let i=Object.getPrototypeOf(s);return i===Object.prototype||i===null}return Object.prototype.toString.call(s)==="[object Object]"}return!1}function g(...s){return s.reduce((i,e)=>{if(e===void 0)return i;if(Array.isArray(e))throw new TypeError("Arguments provided to ts-deepmerge must be objects, not arrays.");return Object.keys(e).forEach(t=>{["__proto__","constructor","prototype"].includes(t)||(Array.isArray(i[t])&&Array.isArray(e[t])?i[t]=g.options.mergeArrays?g.options.uniqueArrayItems?Array.from(new Set(i[t].concat(e[t]))):[...i[t],...e[t]]:e[t]:U(i[t])&&U(e[t])?i[t]=g(i[t],e[t]):!U(i[t])&&U(e[t])?i[t]=g(e[t],void 0):i[t]=e[t]===void 0?g.options.allowUndefinedOverrides?e[t]:i[t]:e[t])}),i},{})}var oe={allowUndefinedOverrides:!0,mergeArrays:!0,uniqueArrayItems:!0};g.options=oe;g.withOptions=(s,...i)=>{g.options=m(m({},oe),s);let e=g(...i);return g.options=oe,e};function Fe(s,i,e){let t=0,n=Date.now(),a=function(...r){let l=this,h=function(){let u=Date.now()-n;i>u?t=window.setTimeout(h,i-u):(t=void 0,e||s.apply(l,r))};t||(t=window.setTimeout(h,i),e&&s.apply(l,r))};return a.cancel=function(){clearTimeout(t),t=void 0},a}function tt(){let s=new WeakMap;return{get(i){return s.get(i)},set(i,e){s.set(i,e)},delete(i){s.delete(i)}}}var le=tt(),L={days:0,months:1,years:1},it=`<div class="${c.picker}"><div class="${c.navigation}"></div><div class="${c.content}"></div></div>`,E=class E extends A{constructor(e,t){super();o(this,"element");o(this,"config");o(this,"input");o(this,"altInput");o(this,"altInputFormat");o(this,"pickerElement");o(this,"navigationElement");o(this,"contentElement");o(this,"buttonsElement",null);o(this,"locale",E.locales.default);o(this,"dateFormat");o(this,"weekStart",0);o(this,"rtl",!1);o(this,"minDate",null);o(this,"maxDate",null);o(this,"minView","days");o(this,"maxView","years");o(this,"inline",!1);o(this,"visible",!1);o(this,"focused",!1);o(this,"focusDate",null);o(this,"viewDate",new Date(H()));o(this,"currentView","days");o(this,"selectedDates",[]);o(this,"lastSelectedDate",null);o(this,"rangeDateFrom",null);o(this,"rangeDateTo",null);o(this,"_disabledDates",[]);o(this,"_enabledDates",[]);o(this,"_isMultipleDates",!1);o(this,"_views",{});o(this,"_navigation");o(this,"_buttons");o(this,"_keyboardNav");o(this,"_container");o(this,"_position");o(this,"_inputType");o(this,"_inputId");o(this,"_inputReadOnly");o(this,"_inputDirection");o(this,"_rendered",!1);o(this,"_editMode",!1);o(this,"_active",!1);o(this,"_clicking",null);o(this,"_showing",!1);o(this,"_hideCallback",null);o(this,"changeSelectedListener");o(this,"changeFocusedListener");o(this,"inputBlurListener");o(this,"inputClickListener");o(this,"inputFocusListener");o(this,"inputMouseDownListener");o(this,"inputPasteListener");o(this,"mouseDownListener");o(this,"mouseUpListener");o(this,"resizeListener");o(this,"adapter",{setPosition:this._setPosition.bind(this),getSelectedDate:this._getSelectedDate.bind(this),handleAlreadySelectedDates:this._handleAlreadySelectedDates.bind(this),setInputValue:this._setInputValue.bind(this),enterEditMode:this._enterEditMode.bind(this),exitEditMode:this._exitEditMode.bind(this)});let n=typeof e=="string"?document.querySelector(e):e;if(!n)throw new Error("Could not find element to initialize DatePicker");this.element=n,this.element.datePicker=this,le.set(this.element,this),this.config=g({},pe(),E.defaults,t),this._parseConfig(),this._initInputs(),this._processDates(),this._limitViewDate(),this.inline=this.config.inline||!this.input,this._container=this._getContainer(),this.pickerElement=document.createElement("div"),this.pickerElement.classList.add(c.datepicker),this.pickerElement.innerHTML=it,this.changeFocusedListener=({detail:{date:a,view:r,moveToOther:l}})=>this._onChangeFocusedDate(a,r,l),this.changeSelectedListener=({detail:{silent:a}})=>this._onChangeSelectedDate(a),this.on("_changeFocusedDate",this.changeFocusedListener),this.on("_changeSelectedDate",this.changeSelectedListener),this._bindConfigEvents(),this.inputBlurListener=this._onBlurInput.bind(this),this.inputClickListener=()=>this._onClickInput(),this.inputFocusListener=()=>this._onFocusInput(),this.inputMouseDownListener=()=>this._onMouseDownInput(),this.inputPasteListener=this._onPasteInput.bind(this),this.mouseDownListener=()=>this._onMouseDown(),this.mouseUpListener=()=>this._onMouseUp(),this.resizeListener=Fe(()=>this._onResize(),300),this.pickerElement.addEventListener("mousedown",this.mouseDownListener),this.pickerElement.addEventListener("mouseup",this.mouseUpListener),(this.input||this.altInput)&&this._bindInputEvents(),this.inline||window.addEventListener("resize",this.resizeListener),this.config.keyboardNav&&(this._keyboardNav=new Y(this)),this.navigationElement=this.pickerElement.querySelector(`.${c.navigation}`),this.contentElement=this.pickerElement.querySelector(`.${c.content}`),this.inline&&this.show()}destroy(){var e,t,n,a;this.off(),this.hide(),this._removeInputEvents(),this.pickerElement.removeEventListener("mousedown",this.mouseDownListener),this.pickerElement.removeEventListener("mouseup",this.mouseUpListener),window.removeEventListener("resize",this.resizeListener),(e=this._keyboardNav)==null||e.destroy(),(t=this._navigation)==null||t.destroy(),this._navigation=null,(n=this._buttons)==null||n.destroy(),this._buttons=null,this.pickerElement.remove(),this.pickerElement=null,this.navigationElement=null,this.contentElement=null,this.buttonsElement=null,this.input&&(this._inputType&&(this.input.type=this._inputType),this._inputId&&(this.input.id=this._inputId),this._inputReadOnly!==void 0&&(this.input.readOnly=this._inputReadOnly)),this.input=null,this.element.dir=this._inputDirection,(a=this.altInput)==null||a.remove(),this.altInput=null,le.delete(this.element),delete this.element.datePicker,this.element=null}isDateSelected(e,t="days"){return this.selectedDates.some(n=>f(e,n,t))}selectDate(e,t=!1){if(Array.isArray(e))return e.map(r=>this.selectDate(r,t)).some(r=>r);if(typeof e=="string"&&this._isMultipleDates)return this.selectDate(e.split(this.config.dateDelimiter||","),t);let n=this.parseDate(e);if(n===void 0||this.isDateDisabled(n))return!1;let a;if(this.config.onBeforeSelect&&!t&&!this.config.onBeforeSelect(n,this)||this.config.range&&this.selectedDates.length===1&&this.isDisabledDateInRange(this.selectedDates[0],n))return!1;if(this.currentView==="days"&&(n.getMonth()!==this.viewDate.getMonth()||n.getFullYear()!==this.viewDate.getFullYear())&&(a=new Date(n.getFullYear(),n.getMonth(),1)),(this.currentView==="years"||this.currentView==="months")&&n.getFullYear()!==this.viewDate.getFullYear()&&(a=new Date(n.getFullYear(),0,1)),a&&this.setViewDate(a),this._isMultipleDates&&!this.config.range){if(this.selectedDates.length===this.config.multipleDates)return!1;this.isDateSelected(n)||this.selectedDates.push(n)}else if(this.config.range)switch(this.selectedDates.length){case 1:this.selectedDates.push(n),this.rangeDateTo||(this.rangeDateTo=n),y(this.rangeDateFrom,this.rangeDateTo)&&(this.rangeDateTo=this.rangeDateFrom,this.rangeDateFrom=n),this.selectedDates=[this.rangeDateFrom,this.rangeDateTo];break;case 2:this.selectedDates=[n],this.rangeDateFrom=n,this.rangeDateTo=null;break;default:this.selectedDates=[n],this.rangeDateFrom=n}else this.selectedDates=[n];return this.trigger("_changeSelectedDate",{date:n,selected:!0,silent:t}),this._setLastSelectedDate(n),this.config.autoClose&&this.visible&&(!this._isMultipleDates&&!this.config.range||this.config.range&&this.selectedDates.length===2)&&this.hide(),!0}deselectDate(e){let t=this.parseDate(e);t!==void 0&&this.selectedDates.some((n,a)=>{if(f(n,t,"days"))return this.selectedDates.splice(a,1),this.selectedDates.length?(this.rangeDateTo=null,this.rangeDateFrom=this.selectedDates[0],this._setLastSelectedDate(this.selectedDates[this.selectedDates.length-1])):(this.rangeDateFrom=null,this.rangeDateTo=null,this._setLastSelectedDate(null)),this.trigger("_changeSelectedDate",{date:t,selected:!1}),!0})}replaceDate(e,t){let n=this.selectedDates.findIndex(a=>f(a,e,this.currentView));n<0||f(this.selectedDates[n],t,this.currentView)||(this.selectedDates[n]=t,this.trigger("_changeSelectedDate",{date:t,selected:!0}),this._setLastSelectedDate(t))}setFocusDate(e,t){this.focusDate=e,this.trigger("_changeFocusedDate",{date:e,view:this.currentView,moveToOther:t})}setViewDate(e){if(f(e,this.viewDate,"days"))return;let t=this.viewDate;this.viewDate=e,this.trigger("changeViewDate",{date:e,oldDate:t,datePicker:this})}next(){let e=this.viewDate.getFullYear(),t=this.viewDate.getMonth();switch(this.currentView){case"days":this.setViewDate(new Date(e,t+1,1));break;case"months":this.setViewDate(new Date(e+1,t,1));break;case"years":this.setViewDate(new Date(e+10,0,1));break}}prev(){let e=this.viewDate.getFullYear(),t=this.viewDate.getMonth();switch(this.currentView){case"days":this.setViewDate(new Date(e,t-1,1));break;case"months":this.setViewDate(new Date(e-1,t,1));break;case"years":this.setViewDate(new Date(e-10,0,1));break}}changeView(e,t=!1){if(e==="up"?e=this.currentView==="days"?"months":"years":e==="down"&&(e=this.currentView==="years"?"months":"days"),!S.includes(e))return;L[e]>L[this.maxView]?e=this.maxView:L[e]<L[this.minView]&&(e=this.minView);let n=this.focusDate||this.viewDate;this.setViewDate(new Date(n.getFullYear(),n.getMonth(),1)),!(!S.includes(e)||this.currentView===e)&&(this.currentView=e,(this.altInput||this.input)&&this.visible&&this._setPosition(void 0,!0),this.trigger("_changeCurrentView",e),this._views[e]||(this._views[e]=new B(this,e),this.contentElement.append(this._views[e].element)),t||this.trigger("changeView",{view:e,datePicker:this}))}isMinView(){return this.currentView===this.minView}isMaxView(){return this.currentView===this.maxView}formatDate(e,t){return Ve(e,t||this.dateFormat,this.locale)}parseDate(e,t){return z(e,t||this.dateFormat,this.locale)}disableDates(e){var n,a;e=Array.isArray(e)?e:[e];let t=this._parseDateRules(e);if(!this._enabledDates.length){this._disabledDates=t,(n=this._views[this.currentView])==null||n.render();return}t.forEach(r=>{if(typeof r=="function"){let l=this._enabledDates.indexOf(r);l>=0&&this._enabledDates.splice(l,1)}else if(r instanceof Date){let l=this._enabledDates.findIndex(h=>h instanceof Date&&f(h,r,"days"));l>=0&&this._enabledDates.splice(l,1)}else{let l=this._enabledDates.findIndex(h=>{if(!(h instanceof Date||typeof h=="function"))return f(h.from,r.from,"days")&&f(h.to,r.to,"days")});l>=0&&this._enabledDates.splice(l,1)}}),(a=this._views[this.currentView])==null||a.render()}enableDates(e){var t;e=typeof e=="boolean"||Array.isArray(e)?e:[e],this._enabledDates=Array.isArray(e)?this._parseDateRules(e):[],this._disabledDates=[],(t=this._views[this.currentView])==null||t.render()}isDateDisabled(e){if(this.minDate&&w(e,this.minDate)||this.maxDate&&y(e,this.maxDate))return!0;if(!this._enabledDates.length&&!this._disabledDates.length)return!1;let t=!this._enabledDates.length,n=this._enabledDates.length?this._enabledDates:this._disabledDates;for(let a=0,r;a<n.length;a++)return r=n[a],typeof r=="function"?r(e)?t:!t:r instanceof Date?r.getTime()===e.getTime()?t:!t:e.getTime()>=r.from.getTime()&&e.getTime()<=r.to.getTime()?t:!t;return!t}isDisabledDateInRange(e,t){[e,t]=R([e,t]);let n=k(t);for(let a=k(e);a<=n;a+=864e5)if(this.isDateDisabled(new Date(a)))return!0;return!1}show(){if(this.visible)return;let e=this.altInput||this.input;if(e){if(e.disabled)return;e!==document.activeElement&&(this._showing=!0,e.focus(),this._showing=!1)}this._render(),this._syncTextDirection(),e&&!this.inline&&this._setPosition(),this.pickerElement.classList.add(c.active),this.visible=!0,this.trigger("show",this)}hide(){!this.visible||this.inline||(this._exitEditMode(),this.visible=!1,this.pickerElement.classList.remove(c.active),this._hideCallback&&(this._hideCallback(),this._hideCallback=null),this.trigger("hide",this))}clear(e=!1){this.selectedDates=[],this.rangeDateFrom=null,this.rangeDateTo=null,this.lastSelectedDate=null,this.trigger("_changeSelectedDate",{date:null,selected:!1,silent:e})}update(e,t=!1){var h,u,d,p,D;let n=this.currentView,a=g({},this.config);this.config=g(this.config,e),this._parseConfig(),this._limitViewDate(),this.currentView=n,this.element.dir=this.rtl?"rtl":"ltr",this.inline=this.config.inline||!this.input,window.removeEventListener("resize",this.resizeListener),this.inline||window.addEventListener("resize",this.resizeListener),!this.config.altInput&&this.altInput&&this._removeAltInput(),this.config.altInput&&(this.altInput&&this.config.altInput instanceof HTMLInputElement&&this.config.altInput!==this.altInput&&this._removeAltInput(),this.altInput||this._createAltInput()),(this.altInput||this.input)&&(this._removeInputEvents(),this._bindInputEvents()),(this.config.multipleDates===0||e.multipleDates===!1)&&(this.config.multipleDates=1),this._isMultipleDates=this.config.multipleDates===!0||this.config.multipleDates>1,this.config.startView!==this.currentView&&this.changeView(this.config.startView,t),this.config.defaultDate&&(this.selectedDates=[],this.selectDate(this.config.defaultDate,t)),this._setInputValue(),a.range&&!this.config.range?(this.rangeDateFrom=null,this.rangeDateTo=null):!a.range&&this.config.range&&this.selectedDates.length&&(this.rangeDateFrom=this.selectedDates[0]||null,this.rangeDateTo=this.selectedDates[1]||null),this.config.buttons&&!this._buttons&&this._rendered&&this._initButtons(),(h=this._buttons)==null||h.update(),a.buttons&&!this.config.buttons&&((u=this.buttonsElement)==null||u.remove(),this.buttonsElement=null,(d=this._buttons)==null||d.destroy(),this._buttons=null);let r=this._getContainer();r!==this._container&&(this._container=r,this._rendered&&this._attachToContainer());let l=this.pickerElement.classList;if(a.classes!==this.config.classes){let P=M(a.classes),T=M(this.config.classes);P.length&&l.remove(...P),T.length&&l.add(...T)}l.add(c.datepicker),l.toggle(c.inline,this.inline),l.toggle(c.hasWeekNumbers,this.config.weekNumbers),(p=this._navigation)==null||p.update(),(this.visible||this.inline)&&(l.add(c.active),(D=this._views[this.currentView])==null||D.update(),this._syncTextDirection(),(this.altInput||this.input)&&!this.inline&&this._setPosition())}isOtherMonth(e){return e.getMonth()!==this.viewDate.getMonth()}isOtherYear(e){return e.getFullYear()!==this.viewDate.getFullYear()}isOtherDecade(e){let[t,n]=v(this.viewDate),a=e.getFullYear();return a<t||a>n}isEditMode(){return this._editMode}_parseConfig(){let e=this.config,{dateFormat:t,locale:n,maxView:a,minView:r,startView:l}=e,h=null;n&&typeof n!="string"?h=n:typeof n=="string"&&n!=="default"&&(E.locales[n]?h=E.locales[n]:(n=n.split("-")[0],E.locales[n]&&(h=E.locales[n]))),this.locale=h?m(m({},E.locales.default),h):E.locales.default,this.dateFormat=t&&re(t)?t:this.locale.format,this.altInputFormat=e.altInputFormat&&re(e.altInputFormat)?e.altInputFormat:X.altInputFormat,this.weekStart=e.weekStart||e.weekStart===0?e.weekStart:this.locale.weekStart,this.rtl=e.rtl!==null?e.rtl:this.locale.rtl||this.element.dir==="rtl"||!1,(e.multipleDates===0||e.multipleDates===!1)&&(e.multipleDates=1),this._isMultipleDates=e.multipleDates===!0||e.multipleDates>1,r&&S.includes(r)&&(this.minView=r),a&&S.includes(a)&&(a=L[a]>=L[this.minView]?a:this.minView,this.maxView=a),l&&S.includes(l)&&(L[l]>L[this.maxView]&&(l=this.maxView),L[l]<L[this.minView]&&(l=this.minView),this.currentView=l),e.maxDate!==null&&(this.maxDate=z(e.maxDate,this.dateFormat,this.locale)||null),e.minDate!==null&&(this.minDate=z(e.minDate,this.dateFormat,this.locale)||null),e.position&&(typeof e.position=="string"?(this._position=this._parsePositionString(e.position),e.position=this._position.y+" "+this._position.x):this._position=e.position)}_parsePositionString(e){let t=e.toLowerCase().split(/\s+/g);return t.length!==2&&(t=[t.find(n=>n==="top"||n==="middle"||n==="bottom")||"auto",t.find(n=>n==="left"||n==="center"||n==="right")||"auto"]),{y:t[0],x:t[1]}}_initInputs(){this.element instanceof HTMLInputElement&&(this.input=this.element,this._inputType=this.input.type,this._inputId=this.input.id,this._inputReadOnly=this.input.readOnly,this.input.type="text",this.input.readOnly=!this.config.allowInput),this._inputDirection=this.element.dir,this.element.dir=this.rtl?"rtl":"ltr",this.config.altInput&&(this.altInput=this._createAltInput())}_bindInputEvents(){let e=this.altInput||this.input,t=this.config.showOn;(t==="click"||t===!0)&&(e.addEventListener("mousedown",this.inputMouseDownListener),e.addEventListener("click",this.inputClickListener)),(t==="focus"||t===!0)&&e.addEventListener("focus",this.inputFocusListener),e.addEventListener("blur",this.inputBlurListener),e.addEventListener("paste",this.inputPasteListener)}_removeInputEvents(){var e,t,n,a,r,l,h,u,d,p;(e=this.input)==null||e.removeEventListener("click",this.inputClickListener),(t=this.input)==null||t.removeEventListener("focus",this.inputFocusListener),(n=this.input)==null||n.removeEventListener("blur",this.inputBlurListener),(a=this.input)==null||a.removeEventListener("mousedown",this.inputMouseDownListener),(r=this.input)==null||r.removeEventListener("paste",this.inputPasteListener),(l=this.altInput)==null||l.removeEventListener("click",this.inputClickListener),(h=this.altInput)==null||h.removeEventListener("focus",this.inputFocusListener),(u=this.altInput)==null||u.removeEventListener("blur",this.inputBlurListener),(d=this.altInput)==null||d.removeEventListener("mousedown",this.inputMouseDownListener),(p=this.altInput)==null||p.removeEventListener("paste",this.inputPasteListener)}_createAltInput(){let e;return this.config.altInput instanceof HTMLInputElement?(e=this.config.altInput,this.input&&(e.dir=this.input.dir)):(e=document.createElement("input"),e.type="text",e.readOnly=!this.config.allowInput,this.input&&(this.input.id&&(e.id=this.input.id),e.placeholder=this.input.placeholder,e.disabled=this.input.disabled,e.required=this.input.required,e.tabIndex=this.input.tabIndex,e.dir=this.input.dir,this.input.type="hidden",this.input.id="")),this.input?this.input.after(e):this.element.contains(this.pickerElement)?this.pickerElement.before(e):this.element.append(e),e}_removeAltInput(){var e;(e=this.altInput)==null||e.remove(),this.altInput=void 0,this.input&&(this.input.type="text",this._inputId&&(this.input.id=this._inputId))}_processDates(){let e=this.config.defaultDate||this.input&&(this.input.placeholder&&this.input.value===this.input.placeholder?null:this.input.value)||this.element.dataset.date||null;e&&this.selectDate(e,!0);let{disabledDates:t,enabledDates:n}=this.config;n&&n.length?this._enabledDates=this._parseDateRules(n):t&&t.length&&(this._disabledDates=this._parseDateRules(t))}_parseDateRules(e){return e.slice().map(t=>{if(typeof t=="function")return t;if(typeof t=="string"||typeof t=="number"||t instanceof Date)return this.parseDate(t);if(t.from&&t.to)return{from:this.parseDate(t.from),to:this.parseDate(t.to)}}).filter(t=>t)}_limitViewDate(){this.maxDate&&y(this.viewDate,this.maxDate)&&this.setViewDate(this.maxDate),this.minDate&&w(this.viewDate,this.minDate)&&this.setViewDate(this.minDate)}_getContainer(){let e=this.config.container;return e?typeof e=="string"?document.querySelector(e)||document.body:e||document.body:document.body}_bindConfigEvents(){if(this.config.onShow){let e=this.config.onShow;this.on("show",()=>e(this))}if(this.config.onHide){let e=this.config.onHide;this.on("hide",()=>e(this))}if(this.config.onFocus){let e=this.config.onFocus;this.on("focus",({detail:{date:t,view:n}})=>e(t,n,this))}if(this.config.onChangeDate){let e=this.config.onChangeDate;this.on("changeDate",({detail:{date:t,formatted:n}})=>e(t,n,this))}if(this.config.onChangeView){let e=this.config.onChangeView;this.on("changeView",({detail:{view:t}})=>e(t,this))}if(this.config.onChangeViewDate){let e=this.config.onChangeViewDate;this.on("changeViewDate",({detail:{date:t,oldDate:n}})=>e(t,n,this))}}_render(){if(this._rendered)return;this._rendered=!0,this._attachToContainer(),this.inline&&this.pickerElement.classList.add(c.inline),this.config.weekNumbers&&this.pickerElement.classList.add(c.hasWeekNumbers);let e=M(this.config.classes);e.length&&this.pickerElement.classList.add(...e),this._views[this.currentView]=new B(this,this.currentView),this.contentElement.append(this._views[this.currentView].element),this._navigation=new W(this),this.navigationElement.append(this._navigation.element),this.config.buttons&&this._initButtons()}_attachToContainer(){this.input?this.inline?this.element.after(this.pickerElement):this._container.append(this.pickerElement):this.element.append(this.pickerElement)}_initButtons(){this.buttonsElement=document.createElement("div"),this.buttonsElement.classList.add(c.buttons),this._buttons=new N(this),this.buttonsElement.append(this._buttons.element),this.pickerElement.firstElementChild.append(this.buttonsElement)}_getInputValue(e){return this.selectedDates.length?this.selectedDates.map(t=>this.formatDate(t,e)).join(this.config.dateDelimiter):""}_setInputValue(){this.altInput&&(this.altInput.value=this._getInputValue(this.altInputFormat));let e=this._getInputValue();this.input?this.input.value=e:this.element.setAttribute("data-date",e),this.element.dispatchEvent(new Event("change",{bubbles:!0}))}_triggerDateChange(){let e=[],t=[],n=this._isMultipleDates||this.config.range;this.selectedDates.length&&(e=this.selectedDates.map(a=>new Date(a)),t=e.map(a=>this.formatDate(a))),this.trigger("changeDate",{date:n?e:e[0],formatted:n?t:t[0],datePicker:this})}_syncTextDirection(){let e=this.altInput||this.input,t=Q(e||this.element),n=(e==null?void 0:e.parentElement)||this.element;!n||t!==Q(n)?this.pickerElement.dir=t:this.pickerElement.dir&&this.pickerElement.removeAttribute("dir")}_setPosition(e,t=!1){if(e=e||this._position,typeof e=="function"){this._hideCallback=e(this.pickerElement,this.element,t,this)||null;return}let n=this.altInput||this.input;if(!n)return;typeof e=="string"&&(e=this._parsePositionString(e));let{y:a,x:r}=e;this.pickerElement.style.display="block";let l=this.pickerElement.getBoundingClientRect(),h=this.pickerElement.offsetParent;this.pickerElement.style.display="";let u=n.getBoundingClientRect(),d=u.top,p=u.left;if(h===document.body||!h)d+=window.scrollY,p+=window.scrollX;else{let b=h.getBoundingClientRect();d-=b.top-h.scrollTop,p-=b.left-h.scrollLeft}let D=this.config.offset,P=G(n),T=0,C=0,{clientHeight:I,clientWidth:_}=document.documentElement;if(P){let b=P.getBoundingClientRect();b.top>0&&(T=b.top),b.left>0&&(C=b.left),b.right<_&&(_=b.right),b.bottom<I&&(I=b.bottom)}let q=0;r==="auto"&&(u.left<C?(r="left",q=C-u.left):u.left+l.width>_?(r="right",_<u.right&&(q=_-u.right)):this.rtl?r=u.right-l.width<C?"left":"right":r="left"),r==="right"?p+=u.width-l.width:r==="center"&&(p+=u.width/2-l.width/2),p+=q,a==="auto"&&(u.top-l.height>T?a=u.bottom+l.height>I?"top":"bottom":a="bottom"),a==="top"?d-=l.height+D:a==="middle"?d+=u.height/2-l.height/2:d+=u.height+D;let he=this.pickerElement.classList;he.remove(...Object.values(c.positions)),he.add(c.positions[r],c.positions[a]),this.pickerElement.style.top=d+"px",this.pickerElement.style.left=p+"px"}_setLastSelectedDate(e){this.lastSelectedDate=e,this.trigger("_changeLastSelectedDate",e||void 0)}_enterEditMode(){let e=this.altInput||this.input;!e||e.readOnly||!this.visible||this._editMode||(this._editMode=!0,e.classList.add(c.editMode))}_exitEditMode(e=!1){let t=this.altInput||this.input;!t||!this._editMode||(this._editMode=!1,t.classList.remove(c.editMode),e&&this._updateFromInput())}_updateFromInput(){let e=this.altInput||this.input;if(!e)return;let t=e.placeholder&&e.value===e.placeholder?null:e.value;if(t){let n=this.selectedDates.slice();this.clear(),this.selectDate(t)||this.selectDate(n)}}_getSelectedDate(e,t="days"){let n=null;return this.selectedDates.some(a=>{let r=f(e,a,t);return n=r&&a||null,r}),n}_handleAlreadySelectedDates(e,t){let n=this.selectedDates.length,a=!!(this.config.range&&n===1&&e),r=a?new Date(t):t;this.config.range&&!this.config.toggleSelected&&(n!==2&&this.selectDate(r),n===2&&f(this.rangeDateFrom,this.rangeDateTo,"days"))||(this.config.toggleSelected?this.deselectDate(r):this._setLastSelectedDate(a?r:e))}_onChangeFocusedDate(e,t,n){e&&((!this.config.range||!this.selectedDates.length)&&this.pickerElement.classList.remove(c.rangeDisabled),this.config.range&&this.selectedDates.length===1&&this.pickerElement.classList.toggle(c.rangeDisabled,this.isDisabledDateInRange(this.selectedDates[0],e)),n&&(this.isOtherMonth(e)||this.isOtherYear(e)||this.isOtherDecade(e))&&this.setViewDate(e),this.trigger("focus",{date:e,view:t,datePicker:this}))}_onChangeSelectedDate(e){setTimeout(()=>{this._setInputValue(),e||this._triggerDateChange()})}_onBlurInput(e){this.focused&&e.stopImmediatePropagation(),!this.focused&&this.visible&&!this.inline&&(this.config.updateOnBlur?this._exitEditMode(!0):this._setInputValue(),this.hide())}_onClickInput(){this._clicking&&(clearTimeout(this._clicking),this._clicking=null,this._active&&this._enterEditMode(),this._active=!1,!this.visible&&!this.inline&&this.show())}_onFocusInput(){!this.visible&&!this.inline&&!this._showing&&this.show()}_onMouseDownInput(){let e=this.config.showOn;(this.visible||e==="click"||e===!0)&&(this._active=document.activeElement===(this.altInput||this.input),this._clicking=window.setTimeout(()=>{this._active=!1,this._clicking=null},2e3))}_onPasteInput(e){var t;this.config.allowInput&&((t=e.clipboardData)!=null&&t.types.includes("text/plain"))&&this._enterEditMode()}_onMouseDown(){this.focused=!0}_onMouseUp(){var e;this.focused=!1,(e=this.altInput||this.input)==null||e.focus()}_onResize(){this.visible&&typeof this.config.position!="function"&&this._setPosition()}static get locales(){return me}static getInstance(e){return le.get(e)}static setDefaults(e){this.defaults=g({},this.defaults,e)}};o(E,"defaults",{});var ce=E;export{ce as default};
//# sourceMappingURL=datepicker.esm.min.js.map
